import{_ as p}from"./plugin-vue_export-helper.21dcd24c.js";import{r as e,o,c,b as s,d as t,e as n,a as l}from"./app.73ec3e73.js";const i={},u=s("h1",{id:"jwt\u7684\u4F7F\u7528",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#jwt\u7684\u4F7F\u7528","aria-hidden":"true"},"#"),n(" JWT\u7684\u4F7F\u7528")],-1),k=n("\u4E3A\u4EC0\u4E48\u4F7F\u7528JWT\uFF0C\u800C\u4E0D\u4F7F\u7528"),r={href:"https://so.csdn.net/so/search?q=session&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"},d=n("session"),m=n("\uFF1F \u6839\u636E\u6211\u7684\u4E86\u89E3\uFF08\u5927\u767D\u8BDD\uFF09\uFF0C\u4F20\u7EDFsession\u662F\u4FDD\u5B58\u5728\u670D\u52A1\u5668"),v={href:"https://so.csdn.net/so/search?q=%E5%86%85%E5%AD%98&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"},b=n("\u5185\u5B58"),g=n("\u4E2D\u7684\uFF0C\u800CJWT\u662F\u4FDD\u5B58\u5728\u6D4F\u89C8\u5668\u672C\u5730\u7684\uFF0C\u4F7F\u7528JWT\u7684\u597D\u5904\u5C31\u662F\u4E0D\u5360\u7528\u670D\u52A1\u5668\u7684\u5185\u5B58\uFF0C\u4F7F\u7528session\u7684\u8BDD\u6BCF\u4E00\u4E2A\u7528\u6237\u90FD\u5360\u7528\u4E00\u70B9\u670D\u52A1\u5668\u7684\u5185\u5B58\uFF0C\u8FD9\u6837\u663E\u7136\u4E0D\u597D\u3002 \u4F7F\u7528JWT\u7684\u8BDD\uFF0C\u7531\u4E8E\u5B83\u662F\u4FDD\u5B58\u5728\u6D4F\u89C8\u5668\u672C\u5730\u7684\uFF0C\u4E0D\u4F1A\u5360\u7528\u670D\u52A1\u5668\u7684\u5185\u5B58\uFF0C\u8FD9\u662F\u4E00\u70B9\u597D\u5904\uFF0C\u5728\u524D\u540E\u7AEF\u5206\u79BB\u7684\u7CFB\u7EDF\u4E2D\u5BF9\u6BD4session\uFF0CJwt\u4F1A\u66F4\u597D\u4E00\u70B9\u3002"),h=l(`<p><strong>header \u548C payload \u90FD\u662F\u7528base64\u6765\u52A0\u5BC6\u7684\uFF0C\u4ED6\u4EEC\u7684\u672C\u4F53\u662Fjson\u6570\u636E\uFF0C\u54B1\u4EEC\u770B\u5230\u7684\u53EA\u662F\u7528base64\u52A0\u5BC6\u540E\u7684</strong><strong>header\u91CC\u5305\u542B\u7684\u5185\u5BB9\u662F jwt\u7684\u7C7B\u578B\u548C\u52A0\u5BC6\u7B97\u6CD5</strong><strong>payload\u91CC\u5305\u542B\u7684\u662F \u975E\u654F\u611F\u4FE1\u606F\uFF0C\u4F8B\u5982\uFF1A\u7528\u6237id\uFF0C\u8D26\u53F7\u2026\u7B49\u7B49\u7528\u6237\u7684\u4FE1\u606F\uFF0C\u5C31\u662F\u4E0D\u8981\u653E\u5BC6\u7801\uFF0C\u4E3A\u4E86\u5B89\u5168\u3002</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code># jwt\u7684\u7ED3\u6784\uFF1A
<span class="token operator">&gt;</span> string <span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> header<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>singnature
### <span class="token number">1.</span>\u4EE4\u724C\u7EC4\u6210
<span class="token operator">-</span> <span class="token number">1.</span>\u6807\u5934\uFF08<span class="token class-name">Header</span>\uFF09
<span class="token operator">-</span> <span class="token number">2.</span>\u6709\u6548\u8F7D\u8377\uFF08<span class="token class-name">Payload</span>\uFF09
<span class="token operator">-</span> <span class="token number">3.</span>\u7B7E\u540D \uFF08<span class="token class-name">Signature</span>\uFF09
<span class="token operator">-</span> \u56E0\u6B64\uFF0CJWT\u901A\u5E38\u5982\u4E0B\u6240\u793A \uFF1A xxxxxx<span class="token punctuation">.</span>yyyyyyy<span class="token punctuation">.</span>zzzzzz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1\u3001\u5F15\u5165\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#_1\u3001\u5F15\u5165\u4F9D\u8D56" aria-hidden="true">#</a> 1\u3001\u5F15\u5165\u4F9D\u8D56</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--\u5F15\u5165jwt--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.auth0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>java-jwt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.10.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2\u3001\u751F\u6210token" tabindex="-1"><a class="header-anchor" href="#_2\u3001\u751F\u6210token" aria-hidden="true">#</a> 2\u3001\u751F\u6210token</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">long</span> EXPIRE_TIME<span class="token operator">=</span><span class="token number">30</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">;</span><span class="token comment">//\u653E\u5728\u7C7B\u4E2D \uFF0C30\u5206\u949F\u7684\u6BEB\u79D2\u6570</span>
		
<span class="token comment">//\u83B7\u53D6\u65F6\u95F4\uFF0C\u7528\u6765\u505Atoken\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u8BBE\u7F6E30\u5206\u949F</span>
<span class="token class-name">Date</span> date<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>EXPIRE_TIME<span class="token punctuation">)</span>

<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> sign <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withHeader</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span> <span class="token comment">//header  \u8FD9\u4E2A\u4E0D\u8BBE\u7F6E\u4E5F\u53EF\u4EE5</span>
    <span class="token punctuation">.</span><span class="token function">withClaim</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">//payload \u5B58\u50A8\u975E\u654F\u611F\u7684\u4FE1\u606F \u4F8B\u5982\u7528\u6237\u8D26\u53F7\uFF0C\u4E0D\u80FD\u5B58\u5BC6\u7801\uFF0C\u9632\u6B62\u88AB\u4EBA\u89E3\u6790</span>
    <span class="token punctuation">.</span><span class="token function">withExpiresAt</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token comment">//\u6307\u5B9A\u4EE4\u724C\u7684\u8FC7\u671F\u65F6\u95F4</span>
    <span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span><span class="token string">&quot;!we2123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token comment">//\u7B7E\u540D  \u4FDD\u5BC6\u590D\u6742</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sign<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u8F93\u51FA\u7ED3\u679C</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code># \u751F\u6210\u7ED3\u679C
<span class="token class-name"><span class="token namespace">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJleHAiOjE2MjY1MzQ3OTIsInVzZXJJZCI6MTIsInVzZXJuYW1lIjoiamZwIn0<span class="token punctuation">.</span></span>GhUCPBptbASHng</span><span class="token operator">-</span><span class="token number">8D</span>kEFIw9jYB2IWStUj3SEgm53x84
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3\u3001\u9A8C\u8BC1token" tabindex="-1"><a class="header-anchor" href="#_3\u3001\u9A8C\u8BC1token" aria-hidden="true">#</a> 3\u3001\u9A8C\u8BC1token</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>\u9A8C\u8BC1\u65F6\u53EF\u4EE5\u52A0\u4E00\u4E2A
<span class="token keyword">try</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	\u4F8B\u5982\u9A8C\u8BC1\u51FA\u73B0\u4E86\u5F02\u5E38\uFF0C\u5C31\u8BC1\u660E\u9A8C\u8BC1\u5931\u8D25 \u76F4\u63A5<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u521B\u5EFA\u9A8C\u8BC1\u5BF9\u8C61</span>
<span class="token comment">//\u9A8C\u8BC1\u65F6\u4E00\u5B9A\u8981\u8DDF\u751F\u6210\u65F6\u7684 \u7B97\u6CD5 \u548C \u7B7E\u540D \u4E00\u81F4</span>
<span class="token class-name">JWTVerifier</span> build <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span><span class="token string">&quot;!we2123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DecodedJWT</span> verify <span class="token operator">=</span> build<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span><span class="token string">&quot; \u8FD9\u91CC\u653Etoken &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
\u4EE5\u4E0A\u4E24\u884C\u4EE3\u7801\u5C31\u5DF2\u7ECF\u5B8C\u6210\u9A8C\u8BC1\u4E86\uFF0C\u5982\u679C\u6CA1\u6709\u51FA\u5F02\u5E38\uFF0C\u5C31\u9A8C\u8BC1\u6210\u529F\uFF01
\u51FA\u73B0\u4E86\u5C31\u662F\u9A8C\u8BC1\u5931\u8D25 \uFF0C\u524D\u63D0\u8981\u4FDD\u8BC1\u7B97\u6CD5\u4E00\u5B9A\u8981\u4E00\u81F4\uFF0C\u4E0D\u8981\u51FA\u73B0\u7B97\u6CD5\u4E0D\u4E00\u81F4\u5F02\u5E38
*/</span>
		
<span class="token comment">//\u83B7\u53D6payload\u5B58\u50A8\u7684\u4FE1\u606F</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>verify<span class="token punctuation">.</span><span class="token function">getClaim</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u5B58\u4EC0\u4E48\u7C7B\u578B \u5C31as\u4EC0\u4E48\u7C7B\u578B\uFF0C\u5426\u5219\u4E3Anull</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>verify<span class="token punctuation">.</span><span class="token function">getClaim</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Date</span> expiresAt <span class="token operator">=</span> verify<span class="token punctuation">.</span><span class="token function">getExpiresAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u67E5\u770Btoken\u8FC7\u671F\u65F6\u95F4</span>
<span class="token class-name">SimpleDateFormat</span> simpleDateFormat<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> format <span class="token operator">=</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>expiresAt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4\u3001jwt\u9A8C\u8BC1\u51FA\u73B0\u7684\u5F02\u5E38" tabindex="-1"><a class="header-anchor" href="#_4\u3001jwt\u9A8C\u8BC1\u51FA\u73B0\u7684\u5F02\u5E38" aria-hidden="true">#</a> 4\u3001jwt\u9A8C\u8BC1\u51FA\u73B0\u7684\u5F02\u5E38</h3><p>\u9A8C\u8BC1\u65F6\u4F1A\u5148\u9A8C\u8BC1\u7B7E\u540D\uFF0C\u518D\u9A8C\u8BC1\u4EE4\u724C\u6709\u6CA1\u6709\u8FC7\u671F</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code># \u7B7E\u540D\u9A8C\u8BC1\u5F02\u5E38 \uFF08\u751F\u6210\u65F6\u548C\u9A8C\u8BC1\u65F6\u7684\u7B7E\u540D\u4E0D\u4E00\u81F4\uFF0C\u4F1A\u51FA\u73B0\u6B64\u5F02\u5E38\uFF09
 <span class="token operator">-</span> <span class="token class-name">SignatureVerificationException</span>
# \u7B97\u6CD5\u4E0D\u5339\u914D\u5F02\u5E38  \uFF08\u751F\u6210\u65F6\u548C\u9A8C\u8BC1\u65F6\u7684\u7B97\u6CD5\u4E0D\u4E00\u81F4\uFF0C\u4F1A\u51FA\u73B0\u6B64\u5F02\u5E38\uFF09
 <span class="token operator">-</span> <span class="token class-name">AlgorithmMismatchException</span>
# \u4EE4\u724C\u8FC7\u671F\u5F02\u5E38 \uFF08\u751F\u6210\u65F6\u8BBE\u7F6E\u7684\u65F6\u95F4\u8D85\u65F6\u540E\uFF0C\u518D\u6B21\u9A8C\u8BC1\u4F1A\u51FA\u73B0\u6B64\u5F02\u5E38\uFF09
 <span class="token operator">-</span> <span class="token class-name">TokenExpiredException</span>
# \u5931\u6548\u7684payload\u5F02\u5E38  \uFF08\u51FA\u73B0\u6B64\u5F02\u5E38\u7684\u539F\u56E0\u6709\uFF1A\u53EF\u80FD\u6709\u4EBA\u4F7F\u7528base64\u89E3\u6790payload\uFF0C\u66F4\u6539\u4E86\u6570\u636Epayload\u91CC\u89E3\u6790\u7684\u6570\u636E\uFF0C\u518D\u6B21\u4F20\u8FC7\u6765\uFF0C\u9A8C\u8BC1\u65F6\u4F1A\u51FA\u73B0\u6B64\u5F02\u5E38\uFF09
 <span class="token operator">-</span> <span class="token class-name">InvalidClaimException</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5\u3001\u5C01\u88C5\u5DE5\u5177\u7C7B" tabindex="-1"><a class="header-anchor" href="#_5\u3001\u5C01\u88C5\u5DE5\u5177\u7C7B" aria-hidden="true">#</a> 5\u3001\u5C01\u88C5\u5DE5\u5177\u7C7B</h3><p>com.imooc.utils\u653E\u5728\u5DE5\u5177\u6587\u4EF6\u5939\u4E2D</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>imooc<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>auth0<span class="token punctuation">.</span>jwt<span class="token punctuation">.</span></span><span class="token class-name">JWT</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>auth0<span class="token punctuation">.</span>jwt<span class="token punctuation">.</span></span><span class="token class-name">JWTCreator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>auth0<span class="token punctuation">.</span>jwt<span class="token punctuation">.</span>algorithms<span class="token punctuation">.</span></span><span class="token class-name">Algorithm</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>auth0<span class="token punctuation">.</span>jwt<span class="token punctuation">.</span>interfaces<span class="token punctuation">.</span></span><span class="token class-name">DecodedJWT</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>



<span class="token comment">//JWT\u5C01\u88C5\u5DE5\u5177\u7C7B</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JWTUtil</span> <span class="token punctuation">{</span>
    <span class="token comment">//30\u5206\u949F</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">long</span> EXPIRE_TIME<span class="token operator">=</span><span class="token number">30</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> SECRET <span class="token operator">=</span> <span class="token string">&quot;token!Q@W#E$R&quot;</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * \u751F\u6210token
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Date</span> date<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>EXPIRE_TIME<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u9ED8\u8BA430\u5206\u949F\u8FC7\u671F</span>
        <span class="token comment">//\u521B\u5EFAJWT builder</span>
        <span class="token class-name">JWTCreator<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// payload</span>
        map<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            builder<span class="token punctuation">.</span><span class="token function">withClaim</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u8FD9\u91CC\u53EF\u4EE5\u5B58\u653E \u7528\u6237id\uFF0C\u7528\u6237\u540D</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">withExpiresAt</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u6307\u5B9A\u4EE4\u724C\u7684\u8FC7\u671F\u65F6\u95F4</span>
        <span class="token comment">//\u5B9E\u9645\u9879\u76EE\u4E2D\u53EF\u4EE5 \u63A5\u6536\u7528\u6237\u7684\u5BC6\u7801\u6765\u505A\u7B7E\u540D,\u8FD9\u6837\u6BCF\u4E00\u4E2A\u7528\u6237\u5BF9\u5E94\u4E00\u4E2A\u7B7E\u540D</span>
        <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> token <span class="token operator">=</span>builder<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>SECRET<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> token<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u9A8C\u8BC1token\u5408\u6CD5\u6027
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u5982\u679C\u629B\u51FA\u5F02\u5E38\uFF0C\u8BC1\u660E\u7B7E\u540D\u4E0D\u4E00\u81F4 / token\u8FC7\u671F</span>
            JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>SECRET<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u83B7\u5F97token\u4E2D\u7684\u4FE1\u606F\u65E0\u9700secret\u89E3\u5BC6\u4E5F\u80FD\u83B7\u5F97
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">DecodedJWT</span> decode <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5047\u8BBE\u5B58\u50A8\u7684\u662F\u4E00\u4E2Aphone</span>
        <span class="token class-name">String</span> phone <span class="token operator">=</span> decode<span class="token punctuation">.</span><span class="token function">getClaim</span><span class="token punctuation">(</span><span class="token string">&quot;phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> phone<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5177\u4F53\u4F7F\u7528\u60C5\u51B5\u5B9E\u6218\u6559\u7A0B</p>`,17);function y(f,w){const a=e("ExternalLinkIcon");return o(),c("div",null,[u,s("p",null,[k,s("a",r,[d,t(a)]),m,s("a",v,[b,t(a)]),g]),h])}var x=p(i,[["render",y],["__file","JWT\u7684\u4F7F\u7528.html.vue"]]);export{x as default};
